<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model selection for semiparametric Bayesian linear regression — sblm_modelsel • SeBR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model selection for semiparametric Bayesian linear regression — sblm_modelsel"><meta name="description" content="Compute model probabilities for semiparametric Bayesian linear regression with
1) an unknown (nonparametric) transformation and 2) a sparsity prior on
the regression coefficients. The model probabilities are computed
using direct Monte Carlo (not MCMC) sampling."><meta property="og:description" content="Compute model probabilities for semiparametric Bayesian linear regression with
1) an unknown (nonparametric) transformation and 2) a sparsity prior on
the regression coefficients. The model probabilities are computed
using direct Monte Carlo (not MCMC) sampling."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeBR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeBR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drkowal/SeBR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model selection for semiparametric Bayesian linear regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/drkowal/SeBR/blob/master/R/experimental_funs.R" class="external-link"><code>R/experimental_funs.R</code></a></small>
      <div class="d-none name"><code>sblm_modelsel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute model probabilities for semiparametric Bayesian linear regression with
1) an unknown (nonparametric) transformation and 2) a sparsity prior on
the regression coefficients. The model probabilities are computed
using direct Monte Carlo (not MCMC) sampling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sblm_modelsel</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  prob_inclusion <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  fixedX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  init_screen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsave <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  override <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ngrid <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code>n x 1</code> response vector</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>n x p</code> matrix of predictors (no intercept)</p></dd>


<dt id="arg-prob-inclusion">prob_inclusion<a class="anchor" aria-label="anchor" href="#arg-prob-inclusion"></a></dt>
<dd><p>prior inclusion probability for each variable</p></dd>


<dt id="arg-psi">psi<a class="anchor" aria-label="anchor" href="#arg-psi"></a></dt>
<dd><p>prior variance (g-prior)</p></dd>


<dt id="arg-fixedx">fixedX<a class="anchor" aria-label="anchor" href="#arg-fixedx"></a></dt>
<dd><p>logical; if TRUE, treat the design as fixed (non-random) when sampling
the transformation; otherwise treat covariates as random with an unknown distribution</p></dd>


<dt id="arg-init-screen">init_screen<a class="anchor" aria-label="anchor" href="#arg-init-screen"></a></dt>
<dd><p>for the initial approximation, number of covariates
to pre-screen (necessary when <code>p &gt; n</code>); if NULL, use n/log(n)</p></dd>


<dt id="arg-nsave">nsave<a class="anchor" aria-label="anchor" href="#arg-nsave"></a></dt>
<dd><p>number of Monte Carlo simulations</p></dd>


<dt id="arg-override">override<a class="anchor" aria-label="anchor" href="#arg-override"></a></dt>
<dd><p>logical; if TRUE, the user may override the default
cancellation of the function call when <code>p &gt; 15</code></p></dd>


<dt id="arg-ngrid">ngrid<a class="anchor" aria-label="anchor" href="#arg-ngrid"></a></dt>
<dd><p>number of grid points for inverse approximations</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; if TRUE, print time remaining</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with the following elements:</p><ul><li><p><code>post_probs</code> the posterior probabilities for each model</p></li>
<li><p><code>all_models</code>: <code>2^p x p</code> matrix where each row corresponds to a model
from <code>post_probs</code> and each column indicates inclusion (TRUE) or exclusion (FALSE) for that variable</p></li>
<li><p><code>model</code>: the model fit (here, <code>sblm_modelsel</code>)</p></li>
</ul><p>as well as the arguments passed in.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function provides fully Bayesian model selection for a
transformed linear model with sparse g-priors on the regression coefficients.
The transformation is modeled as unknown and learned jointly
with the model probabilities. This model applies for real-valued data, positive data, and
compactly-supported data (the support is automatically deduced from the observed <code>y</code> values).</p>
<p>Enumeration of all possible subsets is computationally demanding and
should be reserved only for small <code>p</code>. The function will exit for
<code>p &gt; 15</code> unless an override command is given (<code>override = TRUE</code>).</p>
<p>This function exclusively computes model probabilities and does not
provide other coefficient inference or prediction. Doing so is straightforward,
but omitted here to save on compute time.
For prediction, coefficient inference, and computation
with moderate to large <code>p</code>, use <code><a href="sblm_ssvs.html">sblm_ssvs</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The location (intercept) and scale (<code>sigma_epsilon</code>) are
not identified, so any intercept in <code>X</code> will be removed.
The model-fitting *does* include an internal location-scale
adjustment, but the model probabilities only refer to the
non-intercept variables in <code>X</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Simulate some data:</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="simulate_tlm.html">simulate_tlm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">5</span>, g_type <span class="op">=</span> <span class="st">'beta'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span>; <span class="va">X</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">y</span>, breaks <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="co"># marginal distribution</span></span></span>
<span class="r-plt img"><img src="sblm_modelsel-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Package for conveniently computing all subsets:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the semiparametric Bayesian linear model with model selection:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu">sblm_modelsel</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "10 seconds remaining"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Total time:  19 seconds"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># what is returned</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "post_probs"  "all_models"  "model"       "y"           "X"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "init_screen"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Summarize the probabilities of each model (by size):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">all_models</span><span class="op">)</span>, <span class="va">fit</span><span class="op">$</span><span class="va">post_probs</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'Model sizes'</span>, ylab <span class="op">=</span> <span class="st">'p(model | data)'</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'Posterior model probabilities'</span>, pch <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sblm_modelsel-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Highest probability model:</span></span></span>
<span class="r-in"><span><span class="va">hpm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">post_probs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">post_probs</span><span class="op">[</span><span class="va">hpm</span><span class="op">]</span> <span class="co"># probability</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9404899</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">all_models</span><span class="op">[</span><span class="va">hpm</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># which variables</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 X2 X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">beta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># ground truth</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kowal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

