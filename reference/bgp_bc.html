<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Gaussian processes with a Box-Cox transformation — bgp_bc • SeBR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Gaussian processes with a Box-Cox transformation — bgp_bc"><meta name="description" content="MCMC sampling for Bayesian Gaussian process regression with a
(known or unknown) Box-Cox transformation."><meta property="og:description" content="MCMC sampling for Bayesian Gaussian process regression with a
(known or unknown) Box-Cox transformation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeBR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeBR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drkowal/SeBR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Gaussian processes with a Box-Cox transformation</h1>
      <small class="dont-index">Source: <a href="https://github.com/drkowal/SeBR/blob/master/R/source_compete.R" class="external-link"><code>R/source_compete.R</code></a></small>
      <div class="d-none name"><code>bgp_bc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>MCMC sampling for Bayesian Gaussian process regression with a
(known or unknown) Box-Cox transformation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bgp_bc</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">locs</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covfun_name <span class="op">=</span> <span class="st">"matern_isotropic"</span>,</span>
<span>  locs_test <span class="op">=</span> <span class="va">locs</span>,</span>
<span>  X_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nn <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  emp_bayes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_lambda <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nsave <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nburn <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nskip <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code>n x 1</code> response vector</p></dd>


<dt id="arg-locs">locs<a class="anchor" aria-label="anchor" href="#arg-locs"></a></dt>
<dd><p><code>n x d</code> matrix of locations</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>n x p</code> design matrix; if unspecified, use intercept only</p></dd>


<dt id="arg-covfun-name">covfun_name<a class="anchor" aria-label="anchor" href="#arg-covfun-name"></a></dt>
<dd><p>string name of a covariance function; see ?GpGp</p></dd>


<dt id="arg-locs-test">locs_test<a class="anchor" aria-label="anchor" href="#arg-locs-test"></a></dt>
<dd><p><code>n_test x d</code> matrix of locations
at which predictions are needed; default is <code>locs</code></p></dd>


<dt id="arg-x-test">X_test<a class="anchor" aria-label="anchor" href="#arg-x-test"></a></dt>
<dd><p><code>n_test x p</code> design matrix for test data;
default is <code>X</code></p></dd>


<dt id="arg-nn">nn<a class="anchor" aria-label="anchor" href="#arg-nn"></a></dt>
<dd><p>number of nearest neighbors to use; default is 30
(larger values improve the approximation but increase computing cost)</p></dd>


<dt id="arg-emp-bayes">emp_bayes<a class="anchor" aria-label="anchor" href="#arg-emp-bayes"></a></dt>
<dd><p>logical; if TRUE, use a (faster!) empirical Bayes
approach for estimating the mean function</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Box-Cox transformation; if NULL, estimate this parameter</p></dd>


<dt id="arg-sample-lambda">sample_lambda<a class="anchor" aria-label="anchor" href="#arg-sample-lambda"></a></dt>
<dd><p>logical; if TRUE, sample lambda, otherwise
use the fixed value of lambda above or the MLE (if lambda unspecified)</p></dd>


<dt id="arg-nsave">nsave<a class="anchor" aria-label="anchor" href="#arg-nsave"></a></dt>
<dd><p>number of MCMC iterations to save</p></dd>


<dt id="arg-nburn">nburn<a class="anchor" aria-label="anchor" href="#arg-nburn"></a></dt>
<dd><p>number of MCMC iterations to discard</p></dd>


<dt id="arg-nskip">nskip<a class="anchor" aria-label="anchor" href="#arg-nskip"></a></dt>
<dd><p>number of MCMC iterations to skip between saving iterations,
i.e., save every (nskip + 1)th draw</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with the following elements:</p><ul><li><p><code>coefficients</code> the posterior mean of the regression coefficients</p></li>
<li><p><code>fitted.values</code> the posterior predictive mean at the test points <code>locs_test</code></p></li>
<li><p><code>fit_gp</code> the fitted <code>GpGp_fit</code> object, which includes
covariance parameter estimates and other model information</p></li>
<li><p><code>post_ypred</code>: <code>nsave x n_test</code> samples
from the posterior predictive distribution at <code>locs_test</code></p></li>
<li><p><code>post_g</code>: <code>nsave</code> posterior samples of the transformation
evaluated at the unique <code>y</code> values</p></li>
<li><p><code>post_lambda</code> <code>nsave</code> posterior samples of lambda</p></li>
<li><p><code>model</code>: the model fit (here, <code>bgp_bc</code>)</p></li>
</ul><p>as well as the arguments passed in.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function provides Bayesian inference for
transformed Gaussian processes. The transformation is
parametric from the Box-Cox family, which has one parameter <code>lambda</code>.
That parameter may be fixed in advanced or learned from the data.
For computational efficiency, the Gaussian process parameters are
fixed at point estimates, and the latent Gaussian process is only sampled
when <code>emp_bayes</code> = FALSE.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Box-Cox transformations may be useful in some cases, but
in general we recommend the nonparametric transformation (with
Monte Carlo, not MCMC sampling) in <code><a href="sbgp.html">sbgp</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Simulate some data:</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">200</span> <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="co"># observation points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform a noisy, periodic function:</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="g_inv_bc.html">g_inv_bc</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             lambda <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="co"># Signed square-root transformation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Package we use for fast computing w/ Gaussian processes:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GpGp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a Bayesian Gaussian process with Box-Cox transformation:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu">bgp_bc</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, locs <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Initial GP fit..."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Updated GP fit..."</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># what is returned</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "coefficients"  "fitted.values" "fit_gp"        "post_ypred"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "post_g"        "post_lambda"   "model"         "y"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [9] "X"            </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># estimated regression coefficients (here, just an intercept)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3167961</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">fit_gp</span><span class="op">)</span> <span class="co"># the GpGp object is also returned</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "GpGp_fit"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">post_lambda</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># summary of unknown Box-Cox parameter</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0%   25%   50%   75%  100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.693 0.786 0.813 0.841 0.934 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the model predictions (point and interval estimates):</span></span></span>
<span class="r-in"><span><span class="va">pi_y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">post_ypred</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># 90% PI</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">'n'</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">pi_y</span>,<span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'x'</span>, ylab <span class="op">=</span> <span class="st">'y'</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Fitted values and prediction intervals'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi_y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">pi_y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'gray'</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">'p'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgp_bc-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kowal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

